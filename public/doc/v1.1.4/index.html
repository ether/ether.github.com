<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Etherpad Lite v1.1.4 - Manual &amp; Documentation</title>
  <link rel="stylesheet" href="style.css">
</head>
<body class="apidoc" id="api-section-all">
  <header id="header">
    <h1>Etherpad Lite v1.1.4 - Manual &amp; Documentation</h1>
  </header>

  <div id="toc">
    <h2>Table of Contents</h2>
    <ul>
<li><a href="#all_about_this_documentation">About this Documentation</a></li>
<li><a href="#all_embed_parameters">Embed parameters</a><ul>
<li><a href="#all_showlinenumbers">showLineNumbers</a></li>
<li><a href="#all_showcontrols">showControls</a></li>
<li><a href="#all_showchat">showChat</a></li>
<li><a href="#all_usemonospacefont">useMonospaceFont</a></li>
<li><a href="#all_username">userName</a></li>
<li><a href="#all_nocolors">noColors</a></li>
<li><a href="#all_alwaysshowchat">alwaysShowChat</a></li>
</ul>
</li>
<li><a href="#all_http_api">HTTP API</a><ul>
<li><a href="#all_what_can_i_do_with_this_api">What can I do with this API?</a></li>
<li><a href="#all_examples">Examples</a><ul>
<li><a href="#all_example_1">Example 1</a></li>
<li><a href="#all_example_2">Example 2</a></li>
</ul>
</li>
<li><a href="#all_usage">Usage</a><ul>
<li><a href="#all_request_format">Request Format</a></li>
<li><a href="#all_response_format">Response Format</a></li>
<li><a href="#all_overview">Overview</a></li>
</ul>
</li>
<li><a href="#all_data_types">Data Types</a><ul>
<li><a href="#all_authentication">Authentication</a></li>
<li><a href="#all_node_interoperability">Node Interoperability</a></li>
<li><a href="#all_jsonp">JSONP</a></li>
</ul>
</li>
<li><a href="#all_api_methods">API Methods</a><ul>
<li><a href="#all_groups">Groups</a></li>
<li><a href="#all_author">Author</a></li>
<li><a href="#all_session">Session</a></li>
<li><a href="#all_pad_content">Pad Content</a></li>
<li><a href="#all_pad">Pad</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#all_hooks">Hooks</a><ul>
<li><a href="#all_return_values">Return values</a></li>
</ul>
</li>
<li><a href="#all_client_side_hooks">Client-side hooks</a><ul>
<li><a href="#all_documentready">documentReady</a></li>
<li><a href="#all_acedomlineprocesslineattributes">aceDomLineProcessLineAttributes</a></li>
<li><a href="#all_acecreatedomline">aceCreateDomLine</a></li>
<li><a href="#all_acepostwritedomlinehtml">acePostWriteDomLineHTML</a></li>
<li><a href="#all_aceattribstoclasses">aceAttribsToClasses</a></li>
<li><a href="#all_acegetfilterstack">aceGetFilterStack</a></li>
<li><a href="#all_aceeditorcss">aceEditorCSS</a></li>
<li><a href="#all_aceinitinnerdocbodyhead">aceInitInnerdocbodyHead</a></li>
<li><a href="#all_aceeditevent">aceEditEvent</a></li>
<li><a href="#all_aceregisterblockelements">aceRegisterBlockElements</a></li>
<li><a href="#all_aceinitialized">aceInitialized</a></li>
<li><a href="#all_postaceinit">postAceInit</a></li>
<li><a href="#all_userjoinorupdate">userJoinOrUpdate</a></li>
<li><a href="#all_collectcontentpre">collectContentPre</a></li>
<li><a href="#all_collectcontentpost">collectContentPost</a></li>
<li><a href="#all_handleclientmessage_name">handleClientMessage_<code>name</code></a></li>
<li><a href="#all_acestartlineandcharforpoint_aceendlineandcharforpoint">aceStartLineAndCharForPoint-aceEndLineAndCharForPoint</a></li>
<li><a href="#all_acekeyevent">aceKeyEvent</a></li>
<li><a href="#all_collectcontentlinetext">collectContentLineText</a></li>
<li><a href="#all_collectcontentlinebreak">collectContentLineBreak</a></li>
<li><a href="#all_disableauthorcolorsforthisline">disableAuthorColorsForThisLine</a></li>
</ul>
</li>
<li><a href="#all_server_side_hooks">Server-side hooks</a><ul>
<li><a href="#all_loadsettings">loadSettings</a></li>
<li><a href="#all_pluginuninstall">pluginUninstall</a></li>
<li><a href="#all_plugininstall">pluginInstall</a></li>
<li><a href="#all_init_plugin_name">init_<code>&lt;plugin name&gt;</code></a></li>
<li><a href="#all_expressconfigure">expressConfigure</a></li>
<li><a href="#all_expresscreateserver">expressCreateServer</a></li>
<li><a href="#all_eejsblock_name">eejsBlock_<code>&lt;name&gt;</code></a></li>
<li><a href="#all_socketio">socketio</a></li>
<li><a href="#all_authorize">authorize</a></li>
<li><a href="#all_authenticate">authenticate</a></li>
<li><a href="#all_authfailure">authFailure</a></li>
<li><a href="#all_handlemessage">handleMessage</a></li>
<li><a href="#all_getlinehtmlforexport">getLineHTMLForExport</a></li>
</ul>
</li>
<li><a href="#all_editorinfo">editorInfo</a><ul>
<li><a href="#all_editorinfo_ace_replacerange_start_end_text">editorInfo.ace_replaceRange(start, end, text)</a></li>
<li><a href="#all_editorinfo_ace_getrep">editorInfo.ace_getRep()</a></li>
<li><a href="#all_editorinfo_ace_getauthor">editorInfo.ace_getAuthor()</a></li>
<li><a href="#all_editorinfo_ace_incallstack">editorInfo.ace_inCallStack()</a></li>
<li><a href="#all_editorinfo_ace_incallstackifnecessary">editorInfo.ace_inCallStackIfNecessary(?)</a></li>
<li><a href="#all_editorinfo_ace_focus">editorInfo.ace_focus(?)</a></li>
<li><a href="#all_editorinfo_ace_importtext">editorInfo.ace_importText(?)</a></li>
<li><a href="#all_editorinfo_ace_importatext">editorInfo.ace_importAText(?)</a></li>
<li><a href="#all_editorinfo_ace_exporttext">editorInfo.ace_exportText(?)</a></li>
<li><a href="#all_editorinfo_ace_editorchangedsize">editorInfo.ace_editorChangedSize(?)</a></li>
<li><a href="#all_editorinfo_ace_setonkeypress">editorInfo.ace_setOnKeyPress(?)</a></li>
<li><a href="#all_editorinfo_ace_setonkeydown">editorInfo.ace_setOnKeyDown(?)</a></li>
<li><a href="#all_editorinfo_ace_setnotifydirty">editorInfo.ace_setNotifyDirty(?)</a></li>
<li><a href="#all_editorinfo_ace_dispose">editorInfo.ace_dispose(?)</a></li>
<li><a href="#all_editorinfo_ace_getformattedcode">editorInfo.ace_getFormattedCode(?)</a></li>
<li><a href="#all_editorinfo_ace_seteditable_bool">editorInfo.ace_setEditable(bool)</a></li>
<li><a href="#all_editorinfo_ace_execcommand">editorInfo.ace_execCommand(?)</a></li>
<li><a href="#all_editorinfo_ace_callwithace_fn_callstack_normalize">editorInfo.ace_callWithAce(fn, callStack, normalize)</a></li>
<li><a href="#all_editorinfo_ace_setproperty_key_value">editorInfo.ace_setProperty(key, value)</a></li>
<li><a href="#all_editorinfo_ace_setbasetext_txt">editorInfo.ace_setBaseText(txt)</a></li>
<li><a href="#all_editorinfo_ace_setbaseattributedtext_atxt_apooljsonobj">editorInfo.ace_setBaseAttributedText(atxt, apoolJsonObj)</a></li>
<li><a href="#all_editorinfo_ace_applychangestobase_c_optauthor_apooljsonobj">editorInfo.ace_applyChangesToBase(c, optAuthor, apoolJsonObj)</a></li>
<li><a href="#all_editorinfo_ace_prepareuserchangeset">editorInfo.ace_prepareUserChangeset()</a></li>
<li><a href="#all_editorinfo_ace_applypreparedchangesettobase">editorInfo.ace_applyPreparedChangesetToBase()</a></li>
<li><a href="#all_editorinfo_ace_setuserchangenotificationcallback_f">editorInfo.ace_setUserChangeNotificationCallback(f)</a></li>
<li><a href="#all_editorinfo_ace_setauthorinfo_author_info">editorInfo.ace_setAuthorInfo(author, info)</a></li>
<li><a href="#all_editorinfo_ace_setauthorselectionrange_author_start_end">editorInfo.ace_setAuthorSelectionRange(author, start, end)</a></li>
<li><a href="#all_editorinfo_ace_getunhandlederrors">editorInfo.ace_getUnhandledErrors()</a></li>
<li><a href="#all_editorinfo_ace_getdebugproperty_prop">editorInfo.ace_getDebugProperty(prop)</a></li>
<li><a href="#all_editorinfo_ace_fastincorp">editorInfo.ace_fastIncorp(?)</a></li>
<li><a href="#all_editorinfo_ace_iscaret">editorInfo.ace_isCaret(?)</a></li>
<li><a href="#all_editorinfo_ace_getlineandcharforpoint">editorInfo.ace_getLineAndCharForPoint(?)</a></li>
<li><a href="#all_editorinfo_ace_performdocumentapplyattributestocharrange">editorInfo.ace_performDocumentApplyAttributesToCharRange(?)</a></li>
<li><a href="#all_editorinfo_ace_setattributeonselection">editorInfo.ace_setAttributeOnSelection(?)</a></li>
<li><a href="#all_editorinfo_ace_toggleattributeonselection">editorInfo.ace_toggleAttributeOnSelection(?)</a></li>
<li><a href="#all_editorinfo_ace_performselectionchange">editorInfo.ace_performSelectionChange(?)</a></li>
<li><a href="#all_editorinfo_ace_doindentoutdent">editorInfo.ace_doIndentOutdent(?)</a></li>
<li><a href="#all_editorinfo_ace_doundoredo">editorInfo.ace_doUndoRedo(?)</a></li>
<li><a href="#all_editorinfo_ace_doinsertunorderedlist">editorInfo.ace_doInsertUnorderedList(?)</a></li>
<li><a href="#all_editorinfo_ace_doinsertorderedlist">editorInfo.ace_doInsertOrderedList(?)</a></li>
<li><a href="#all_editorinfo_ace_performdocumentapplyattributestorange">editorInfo.ace_performDocumentApplyAttributesToRange()</a></li>
<li><a href="#all_editorinfo_ace_getauthorinfos">editorInfo.ace_getAuthorInfos()</a></li>
<li><a href="#all_editorinfo_ace_performdocumentreplacerange_start_end_newtext">editorInfo.ace_performDocumentReplaceRange(start, end, newText)</a></li>
<li><a href="#all_editorinfo_ace_performdocumentreplacecharrange_startchar_endchar_newtext">editorInfo.ace_performDocumentReplaceCharRange(startChar, endChar, newText)</a></li>
<li><a href="#all_editorinfo_ace_renumberlist_linenum">editorInfo.ace_renumberList(lineNum)</a></li>
<li><a href="#all_editorinfo_ace_doreturnkey">editorInfo.ace_doReturnKey()</a></li>
<li><a href="#all_editorinfo_ace_isblockelement_element">editorInfo.ace_isBlockElement(element)</a></li>
<li><a href="#all_editorinfo_ace_getlinelisttype_linenum">editorInfo.ace_getLineListType(lineNum)</a></li>
<li><a href="#all_editorinfo_ace_caretline">editorInfo.ace_caretLine()</a></li>
<li><a href="#all_editorinfo_ace_caretcolumn">editorInfo.ace_caretColumn()</a></li>
<li><a href="#all_editorinfo_ace_caretdocchar">editorInfo.ace_caretDocChar()</a></li>
<li><a href="#all_editorinfo_ace_iswordchar">editorInfo.ace_isWordChar(?)</a></li>
</ul>
</li>
<li><a href="#all_changeset_library">Changeset Library</a><ul>
<li><a href="#all_changeset_unpack_changeset">Changeset.unpack(changeset)</a></li>
<li><a href="#all_changeset_opiterator_ops">Changeset.opIterator(ops)</a></li>
<li><a href="#all_the_operator_object">The Operator object</a><ul>
<li><a href="#all_example">Example</a></li>
</ul>
</li>
<li><a href="#all_apool">APool</a></li>
<li><a href="#all_atext">AText</a></li>
</ul>
</li>
<li><a href="#all_database_structure">Database structure</a><ul>
<li><a href="#all_keys_and_their_values">Keys and their values</a><ul>
<li><a href="#all_groups_1">groups</a></li>
<li><a href="#all_pad_padid">pad:$PADID</a></li>
<li><a href="#all_pad_padid_revs_revnum">pad:$PADID:revs:$REVNUM</a></li>
<li><a href="#all_pad_padid_chat_chatnum">pad:$PADID:chat:$CHATNUM</a></li>
<li><a href="#all_pad2readonly_padid">pad2readonly:$PADID</a></li>
<li><a href="#all_readonly2pad_readonlyid">readonly2pad:$READONLYID</a></li>
<li><a href="#all_token2author_tokenid">token2author:$TOKENID</a></li>
<li><a href="#all_globalauthor_authorid">globalAuthor:$AUTHORID</a></li>
<li><a href="#all_mapper2group_mapper">mapper2group:$MAPPER</a></li>
<li><a href="#all_mapper2author_mapper">mapper2author:$MAPPER</a></li>
<li><a href="#all_group_groupid">group:$GROUPID</a></li>
<li><a href="#all_session_sessionid">session:$SESSIONID</a></li>
<li><a href="#all_author2sessions_authorid">author2sessions:$AUTHORID</a></li>
<li><a href="#all_group2sessions_groupid">group2sessions:$GROUPID</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>

  <div id="apicontent">
    <h1>About this Documentation<span><a class="mark" href="#all_about_this_documentation" id="all_about_this_documentation">#</a></span></h1>
<!-- type=misc -->

<p>The goal of this documentation is to comprehensively explain Etherpad-Lite,
both from a reference as well as a conceptual point of view.

</p>
<p>Where appropriate, property types, method arguments, and the arguments
provided to event handlers are detailed in a list underneath the topic
heading.

</p>
<p>Every <code>.html</code> file is generated based on the corresponding
<code>.md</code> file in the <code>doc/</code> folder in the source tree. The
documentation is generated using <code>tools/doc/generate.js</code>.
The HTML template is located at <code>doc/template.html</code>.
</p>
<h1>Embed parameters<span><a class="mark" href="#all_embed_parameters" id="all_embed_parameters">#</a></span></h1>
<p>You can easily embed your etherpad-lite into any webpage by using iframes. You can configure the embedded pad using embed paramters.

</p>
<p>Example:

</p>
<p>Cut and paste the following code into any webpage to embed a pad. The parameters below will hide the chat and the line numbers.

</p>
<pre><code>&lt;iframe src=&apos;http://pad.test.de/p/PAD_NAME?showChat=false&amp;showLineNumbers=false&apos; width=600 height=400&gt;&lt;/iframe&gt;</code></pre>
<h2>showLineNumbers<span><a class="mark" href="#all_showlinenumbers" id="all_showlinenumbers">#</a></span></h2>
<div class="signature"><ul>
<li>Boolean</li>
</div></ul>
<p>Default: true

</p>
<h2>showControls<span><a class="mark" href="#all_showcontrols" id="all_showcontrols">#</a></span></h2>
<div class="signature"><ul>
<li>Boolean</li>
</div></ul>
<p>Default: true

</p>
<h2>showChat<span><a class="mark" href="#all_showchat" id="all_showchat">#</a></span></h2>
<div class="signature"><ul>
<li>Boolean</li>
</div></ul>
<p>Default: true

</p>
<h2>useMonospaceFont<span><a class="mark" href="#all_usemonospacefont" id="all_usemonospacefont">#</a></span></h2>
<div class="signature"><ul>
<li>Boolean</li>
</div></ul>
<p>Default: false

</p>
<h2>userName<span><a class="mark" href="#all_username" id="all_username">#</a></span></h2>
<div class="signature"><ul>
<li>String</li>
</div></ul>
<p>Default: &quot;unnamed&quot;

</p>
<p>Example: <code>userName=Etherpad%20User</code>

</p>
<h2>noColors<span><a class="mark" href="#all_nocolors" id="all_nocolors">#</a></span></h2>
<div class="signature"><ul>
<li>Boolean</li>
</div></ul>
<p>Default: false

</p>
<h2>alwaysShowChat<span><a class="mark" href="#all_alwaysshowchat" id="all_alwaysshowchat">#</a></span></h2>
<div class="signature"><ul>
<li>Boolean</li>
</div></ul>
<p>Default: false

</p>
<h1>HTTP API<span><a class="mark" href="#all_http_api" id="all_http_api">#</a></span></h1>
<h2>What can I do with this API?<span><a class="mark" href="#all_what_can_i_do_with_this_api" id="all_what_can_i_do_with_this_api">#</a></span></h2>
<p>The API gives another web application control of the pads. The basic functions are

</p>
<ul>
<li>create/delete pads </li>
<li>grant/forbid access to pads</li>
<li>get/set pad content</li>
</ul>
<p>The API is designed in a way, so you can reuse your existing user system with their permissions, and map it to etherpad lite. Means: Your web application still has to do authentication, but you can tell etherpad lite via the api, which visitors should get which permissions. This allows etherpad lite to fit into any web application and extend it with real-time functionality. You can embed the pads via an iframe into your website.

</p>
<p>Take a look at <a href="https://github.com/Pita/etherpad-lite/wiki/HTTP-API-client-libraries">HTTP API client libraries</a> to see if a library in your favorite language.

</p>
<h2>Examples<span><a class="mark" href="#all_examples" id="all_examples">#</a></span></h2>
<h3>Example 1<span><a class="mark" href="#all_example_1" id="all_example_1">#</a></span></h3>
<p>A portal (such as WordPress) wants to give a user access to a new pad. Let&apos;s assume the user have the internal id 7 and his name is michael. 

</p>
<p>Portal maps the internal userid to an etherpad author. 

</p>
<blockquote>
<p>Request: <code>http://pad.domain/api/1/createAuthorIfNotExistsFor?apikey=secret&amp;name=Michael&amp;authorMapper=7</code>

</p>
<p>Response: <code>{code: 0, message:&quot;ok&quot;, data: {authorID: &quot;a.s8oes9dhwrvt0zif&quot;}}</code>

</p>
</blockquote>
<p>Portal maps the internal userid to an etherpad group:

</p>
<blockquote>
<p>Request: <code>http://pad.domain/api/1/createGroupIfNotExistsFor?apikey=secret&amp;groupMapper=7</code>

</p>
<p>Response: <code>{code: 0, message:&quot;ok&quot;, data: {groupID: &quot;g.s8oes9dhwrvt0zif&quot;}}</code>

</p>
</blockquote>
<p>Portal creates a pad in the userGroup

</p>
<blockquote>
<p>Request: <code>http://pad.domain/api/1/createGroupPad?apikey=secret&amp;groupID=g.s8oes9dhwrvt0zif&amp;padName=samplePad&amp;text=This is the first sentence in the pad</code>

</p>
<p>Response: <code>{code: 0, message:&quot;ok&quot;, data: null}</code>

</p>
</blockquote>
<p>Portal starts the session for the user on the group:

</p>
<blockquote>
<p>Request: <code>http://pad.domain/api/1/createSession?apikey=secret&amp;groupID=g.s8oes9dhwrvt0zif&amp;authorID=a.s8oes9dhwrvt0zif&amp;validUntil=1312201246</code>

</p>
<p>Response: <code>{&quot;data&quot;:{&quot;sessionID&quot;: &quot;s.s8oes9dhwrvt0zif&quot;}}</code>

</p>
</blockquote>
<p>Portal places the cookie &quot;sessionID&quot; with the given value on the client and creates an iframe including the pad.

</p>
<h3>Example 2<span><a class="mark" href="#all_example_2" id="all_example_2">#</a></span></h3>
<p>A portal (such as WordPress) wants to transform the contents of a pad that multiple admins edited into a blog post.

</p>
<p>Portal retrieves the contents of the pad for entry into the db as a blog post:

</p>
<blockquote>
<p>Request: <code>http://pad.domain/api/1/getText?apikey=secret&amp;padID=g.s8oes9dhwrvt0zif$123</code>

</p>
<p>Response: <code>{code: 0, message:&quot;ok&quot;, data: {text:&quot;Welcome Text&quot;}}</code>

</p>
</blockquote>
<p>Portal submits content into new blog post

</p>
<blockquote>
<p>Portal.AddNewBlog(content)


</p>
</blockquote>
<h2>Usage<span><a class="mark" href="#all_usage" id="all_usage">#</a></span></h2>
<h3>Request Format<span><a class="mark" href="#all_request_format" id="all_request_format">#</a></span></h3>
<p>The API is accessible via HTTP. HTTP Requests are in the format /api/$APIVERSION/$FUNCTIONNAME. Parameters are transmitted via HTTP GET. $APIVERSION is 1

</p>
<h3>Response Format<span><a class="mark" href="#all_response_format" id="all_response_format">#</a></span></h3>
<p>Responses are valid JSON in the following format:

</p>
<pre><code class="js">{
  &quot;code&quot;: number,
  &quot;message&quot;: string,
  &quot;data&quot;: obj
}</code></pre>
<ul>
<li><strong>code</strong> a return code<ul>
<li><strong>0</strong> everything ok</li>
<li><strong>1</strong> wrong parameters</li>
<li><strong>2</strong> internal error</li>
<li><strong>3</strong> no such function</li>
<li><strong>4</strong> no or wrong API Key</li>
</ul>
</li>
<li><strong>message</strong> a status message. Its ok if everything is fine, else it contains an error message</li>
<li><strong>data</strong> the payload</li>
</ul>
<h3>Overview<span><a class="mark" href="#all_overview" id="all_overview">#</a></span></h3>
<p><img src="http://i.imgur.com/d0nWp.png" alt="API Overview">

</p>
<h2>Data Types<span><a class="mark" href="#all_data_types" id="all_data_types">#</a></span></h2>
<div class="signature"><ul>
<li><strong>groupID</strong>  a string, the unique id of a group. Format is g.16RANDOMCHARS, for example g.s8oes9dhwrvt0zif</li>
<li><strong>sessionID</strong> a string, the unique id of a session. Format is s.16RANDOMCHARS, for example s.s8oes9dhwrvt0zif</li>
<li><strong>authorID</strong> a string, the unique id of an author. Format is a.16RANDOMCHARS, for example a.s8oes9dhwrvt0zif</li>
<li><strong>readOnlyID</strong> a string, the unique id of an readonly relation to a pad. Format is r.16RANDOMCHARS, for example r.s8oes9dhwrvt0zif</li>
<li><strong>padID</strong> a string, format is GROUPID$PADNAME, for example the pad test of group g.s8oes9dhwrvt0zif has padID g.s8oes9dhwrvt0zif$test</li>
</div></ul>
<h3>Authentication<span><a class="mark" href="#all_authentication" id="all_authentication">#</a></span></h3>
<p>Authentication works via a token that is sent with each request as a post parameter.  There is a single token per Etherpad-Lite deployment.  This token will be random string, generated by Etherpad-Lite at the first start. It will be saved in APIKEY.txt in the root folder of Etherpad Lite. Only Etherpad Lite and the requesting application knows this key. Token management will not be exposed through this API. 

</p>
<h3>Node Interoperability<span><a class="mark" href="#all_node_interoperability" id="all_node_interoperability">#</a></span></h3>
<p>All functions will also be available through a node module accessable from other node.js applications.

</p>
<h3>JSONP<span><a class="mark" href="#all_jsonp" id="all_jsonp">#</a></span></h3>
<p>The API provides <em>JSONP</em> support to allow requests from a server in a different domain.
Simply add <code>&amp;jsonp=?</code> to the API call.

</p>
<p>Example usage: <a href="http://api.jquery.com/jQuery.getJSON/">http://api.jquery.com/jQuery.getJSON/</a>

</p>
<h2>API Methods<span><a class="mark" href="#all_api_methods" id="all_api_methods">#</a></span></h2>
<h3>Groups<span><a class="mark" href="#all_groups" id="all_groups">#</a></span></h3>
<p>Pads can belong to a group. The padID of grouppads is starting with a groupID like g.asdfasdfasdfasdf$test

</p>
<ul>
<li><strong>createGroup()</strong> creates a new group <br><br><em>Example returns:</em><ul>
<li><code>{code: 0, message:&quot;ok&quot;, data: {groupID: g.s8oes9dhwrvt0zif}}</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>createGroupIfNotExistsFor(groupMapper)</strong> this functions helps you to map your application group ids to etherpad lite group ids <br><br><em>Example returns:</em><ul>
<li><code>{code: 0, message:&quot;ok&quot;, data: {groupID: g.s8oes9dhwrvt0zif}}</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>deleteGroup(groupID)</strong> deletes a group <br><br><em>Example returns:</em><ul>
<li><code>{code: 0, message:&quot;ok&quot;, data: null}</code></li>
<li><code>{code: 1, message:&quot;groupID does not exist&quot;, data: null}</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>listPads(groupID)</strong> returns all pads of this group<br><br><em>Example returns:</em><ul>
<li><code>{code: 0, message:&quot;ok&quot;, data: {padIDs : [&quot;g.s8oes9dhwrvt0zif$test&quot;, &quot;g.s8oes9dhwrvt0zif$test2&quot;]}</code></li>
<li><code>{code: 1, message:&quot;groupID does not exist&quot;, data: null}</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>createGroupPad(groupID, padName [, text])</strong> creates a new pad in this group <br><br><em>Example returns:</em><ul>
<li><code>{code: 0, message:&quot;ok&quot;, data: null}</code></li>
<li><code>{code: 1, message:&quot;pad does already exist&quot;, data: null}</code></li>
<li><code>{code: 1, message:&quot;groupID does not exist&quot;, data: null}</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>listAllGroups()</strong> lists all existing groups<br><br><em>Example returns:</em><ul>
<li><code>{code: 0, message:&quot;ok&quot;, data: {groupIDs: [&quot;g.mKjkmnAbSMtCt8eL&quot;, &quot;g.3ADWx6sbGuAiUmCy&quot;]}}</code></li>
<li><code>{code: 0, message:&quot;ok&quot;, data: {groupIDs: []}}</code></li>
</ul>
</li>
</ul>
<h3>Author<span><a class="mark" href="#all_author" id="all_author">#</a></span></h3>
<p>These authors are bound to the attributes the users choose (color and name). 

</p>
<ul>
<li><strong>createAuthor([name])</strong> creates a new author <br><br><em>Example returns:</em><ul>
<li><code>{code: 0, message:&quot;ok&quot;, data: {authorID: &quot;a.s8oes9dhwrvt0zif&quot;}}</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>createAuthorIfNotExistsFor(authorMapper [, name])</strong> this functions helps you to map your application author ids to etherpad lite author ids <br><br><em>Example returns:</em><ul>
<li><code>{code: 0, message:&quot;ok&quot;, data: {authorID: &quot;a.s8oes9dhwrvt0zif&quot;}}</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>listPadsOfAuthor(authorID)</strong> returns an array of all pads this author contributed to<br><br><em>Example returns:</em><ul>
<li><code>{code: 0, message:&quot;ok&quot;, data: {padIDs: [&quot;g.s8oes9dhwrvt0zif$test&quot;, &quot;g.s8oejklhwrvt0zif$foo&quot;]}}</code></li>
<li><code>{code: 1, message:&quot;authorID does not exist&quot;, data: null}</code></li>
</ul>
</li>
</ul>
<ul>
<li><p><strong>getAuthorName(authorID)</strong> Returns the Author Name of the author <br><br><em>Example returns:</em></p>
<ul>
<li><code>{code: 0, message:&quot;ok&quot;, data: {authorName: &quot;John McLear&quot;}}</code></li>
</ul>
</li>
<li><blockquote>
<p>can&apos;t be deleted cause this would involve scanning all the pads where this author was</p>
</blockquote>
</li>
</ul>
<h3>Session<span><a class="mark" href="#all_session" id="all_session">#</a></span></h3>
<p>Sessions can be created between a group and an author. This allows an author to access more than one group. The sessionID will be set as a cookie to the client and is valid until a certain date. The session cookie can also contain multiple comma-seperated sessionIDs, allowing a user to edit pads in different groups at the same time. Only users with a valid session for this group, can access group pads. You can create a session after you authenticated the user at your web application, to give them access to the pads. You should save the sessionID of this session and delete it after the user logged out.

</p>
<ul>
<li><strong>createSession(groupID, authorID, validUntil)</strong> creates a new session. validUntil is an unix timestamp in seconds <br><br><em>Example returns:</em><ul>
<li><code>{code: 0, message:&quot;ok&quot;, data: {sessionID: &quot;s.s8oes9dhwrvt0zif&quot;}}</code></li>
<li><code>{code: 1, message:&quot;groupID doesn&apos;t exist&quot;, data: null}</code></li>
<li><code>{code: 1, message:&quot;authorID doesn&apos;t exist&quot;, data: null}</code></li>
<li><code>{code: 1, message:&quot;validUntil is in the past&quot;, data: null}</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>deleteSession(sessionID)</strong> deletes a session <br><br><em>Example returns:</em><ul>
<li><code>{code: 1, message:&quot;ok&quot;, data: null}</code></li>
<li><code>{code: 1, message:&quot;sessionID does not exist&quot;, data: null}</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>getSessionInfo(sessionID)</strong> returns informations about a session <br><br><em>Example returns:</em><ul>
<li><code>{code: 0, message:&quot;ok&quot;, data: {authorID: &quot;a.s8oes9dhwrvt0zif&quot;, groupID: g.s8oes9dhwrvt0zif, validUntil: 1312201246}}</code></li>
<li><code>{code: 1, message:&quot;sessionID does not exist&quot;, data: null}</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>listSessionsOfGroup(groupID)</strong> returns all sessions of a group <br><br><em>Example returns:</em><ul>
<li><code>{&quot;code&quot;:0,&quot;message&quot;:&quot;ok&quot;,&quot;data&quot;:{&quot;s.oxf2ras6lvhv2132&quot;:{&quot;groupID&quot;:&quot;g.s8oes9dhwrvt0zif&quot;,&quot;authorID&quot;:&quot;a.akf8finncvomlqva&quot;,&quot;validUntil&quot;:2312905480}}}</code></li>
<li><code>{code: 1, message:&quot;groupID does not exist&quot;, data: null}</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>listSessionsOfAuthor(authorID)</strong> returns all sessions of an author <br><br><em>Example returns:</em><ul>
<li><code>{&quot;code&quot;:0,&quot;message&quot;:&quot;ok&quot;,&quot;data&quot;:{&quot;s.oxf2ras6lvhv2132&quot;:{&quot;groupID&quot;:&quot;g.s8oes9dhwrvt0zif&quot;,&quot;authorID&quot;:&quot;a.akf8finncvomlqva&quot;,&quot;validUntil&quot;:2312905480}}}</code></li>
<li><code>{code: 1, message:&quot;authorID does not exist&quot;, data: null}</code></li>
</ul>
</li>
</ul>
<h3>Pad Content<span><a class="mark" href="#all_pad_content" id="all_pad_content">#</a></span></h3>
<p>Pad content can be updated and retrieved through the API

</p>
<ul>
<li><strong>getText(padID, [rev])</strong> returns the text of a pad <br><br><em>Example returns:</em><ul>
<li><code>{code: 0, message:&quot;ok&quot;, data: {text:&quot;Welcome Text&quot;}}</code></li>
<li><code>{code: 1, message:&quot;padID does not exist&quot;, data: null}</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>setText(padID, text)</strong> sets the text of a pad <br><br><em>Example returns:</em><ul>
<li><code>{code: 0, message:&quot;ok&quot;, data: null}</code></li>
<li><code>{code: 1, message:&quot;padID does not exist&quot;, data: null}</code></li>
<li><code>{code: 1, message:&quot;text too long&quot;, data: null}</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>getHTML(padID, [rev])</strong> returns the text of a pad formatted as HTML<br><br><em>Example returns:</em><ul>
<li><code>{code: 0, message:&quot;ok&quot;, data: {html:&quot;Welcome Text&lt;br&gt;More Text&quot;}}</code></li>
<li><code>{code: 1, message:&quot;padID does not exist&quot;, data: null}</code></li>
</ul>
</li>
</ul>
<h3>Pad<span><a class="mark" href="#all_pad" id="all_pad">#</a></span></h3>
<p>Group pads are normal pads, but with the name schema GROUPID$PADNAME. A security manager controls access of them and its forbidden for normal pads to include a $ in the name. 

</p>
<ul>
<li><strong>createPad(padID [, text])</strong> creates a new (non-group) pad.  Note that if you need to create a group Pad, you should call <strong>createGroupPad</strong>.<br><br><em>Example returns:</em><ul>
<li><code>{code: 0, message:&quot;ok&quot;, data: null}</code></li>
<li><code>{code: 1, message:&quot;pad does already exist&quot;, data: null}</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>getRevisionsCount(padID)</strong> returns the number of revisions of this pad <br><br><em>Example returns:</em><ul>
<li><code>{code: 0, message:&quot;ok&quot;, data: {revisions: 56}}</code></li>
<li><code>{code: 1, message:&quot;padID does not exist&quot;, data: null}</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>padUsersCount(padID)</strong> returns the number of user that are currently editing this pad <br><br><em>Example returns:</em><ul>
<li><code>{code: 0, message:&quot;ok&quot;, data: {padUsersCount: 5}}</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>padUsers(padID)</strong> returns the list of users that are currently editing this pad <br><br><em>Example returns:</em><ul>
<li><code>{code: 0, message:&quot;ok&quot;, data: {padUsers: [{colorId:&quot;#c1a9d9&quot;,&quot;name&quot;:&quot;username1&quot;,&quot;timestamp&quot;:1345228793126},{&quot;colorId&quot;:&quot;#d9a9cd&quot;,&quot;name&quot;:&quot;Hmmm&quot;,&quot;timestamp&quot;:1345228796042}]}}</code></li>
<li><code>{code: 0, message:&quot;ok&quot;, data: {padUsers: []}}</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>deletePad(padID)</strong> deletes a pad <br><br><em>Example returns:</em><ul>
<li><code>{code: 0, message:&quot;ok&quot;, data: null}</code></li>
<li><code>{code: 1, message:&quot;padID does not exist&quot;, data: null}</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>getReadOnlyID(padID)</strong> returns the read only link of a pad <br><br><em>Example returns:</em><ul>
<li><code>{code: 0, message:&quot;ok&quot;, data: {readOnlyID: &quot;r.s8oes9dhwrvt0zif&quot;}}</code></li>
<li><code>{code: 1, message:&quot;padID does not exist&quot;, data: null}</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>setPublicStatus(padID, publicStatus)</strong> sets a boolean for the public status of a pad <br><br><em>Example returns:</em><ul>
<li><code>{code: 0, message:&quot;ok&quot;, data: null}</code></li>
<li><code>{code: 1, message:&quot;padID does not exist&quot;, data: null}</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>getPublicStatus(padID)</strong> return true of false <br><br><em>Example returns:</em><ul>
<li><code>{code: 0, message:&quot;ok&quot;, data: {publicStatus: true}}</code></li>
<li><code>{code: 1, message:&quot;padID does not exist&quot;, data: null}</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>setPassword(padID, password)</strong> returns ok or a error message <br><br><em>Example returns:</em><ul>
<li><code>{code: 0, message:&quot;ok&quot;, data: null}</code></li>
<li><code>{code: 1, message:&quot;padID does not exist&quot;, data: null}</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>isPasswordProtected(padID)</strong> returns true or false <br><br><em>Example returns:</em><ul>
<li><code>{code: 0, message:&quot;ok&quot;, data: {passwordProtection: true}}</code></li>
<li><code>{code: 1, message:&quot;padID does not exist&quot;, data: null}</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>listAuthorsOfPad(padID)</strong> returns an array of authors who contributed to this pad <br><br><em>Example returns:</em><ul>
<li><code>{code: 0, message:&quot;ok&quot;, data: {authorIDs : [&quot;a.s8oes9dhwrvt0zif&quot;, &quot;a.akf8finncvomlqva&quot;]}</code></li>
<li><code>{code: 1, message:&quot;padID does not exist&quot;, data: null}</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>getLastEdited(padID)</strong> returns the timestamp of the last revision of the pad <br><br><em>Example returns:</em><ul>
<li><code>{code: 0, message:&quot;ok&quot;, data: {lastEdited: 1340815946602}}</code></li>
<li><code>{code: 1, message:&quot;padID does not exist&quot;, data: null}</code></li>
</ul>
</li>
</ul>
<ul>
<li><strong>sendClientsMessage(padID, msg)</strong> sends a custom message of type <code>msg</code> to the pad <br><br><em>Example returns:</em><ul>
<li><code>{code: 0, message:&quot;ok&quot;, data: {}}</code></li>
<li><code>{code: 1, message:&quot;padID does not exist&quot;, data: null}</code></li>
</ul>
</li>
</ul>
<h1>Hooks<span><a class="mark" href="#all_hooks" id="all_hooks">#</a></span></h1>
<p>All hooks are called with two arguments:

</p>
<ol>
<li>name - the name of the hook being called</li>
<li>context - an object with some relevant information about the context of the call</li>
</ol>
<h2>Return values<span><a class="mark" href="#all_return_values" id="all_return_values">#</a></span></h2>
<p>A hook should always return a list or undefined. Returning undefined is equivalent to returning an empty list.
All the returned lists are appended to each other, so if the return values where <code>[1, 2]</code>, <code>undefined</code>, <code>[3, 4,]</code>, <code>undefined</code> and <code>[5]</code>, the value returned by callHook would be <code>[1, 2, 3, 4, 5]</code>.

</p>
<p>This is, because it should never matter if you have one plugin or several plugins doing some work - a single plugin should be able to make callHook return the same value a set of plugins are able to return collectively. So, any plugin can return a list of values, of any length, not just one value.
</p>
<h1>Client-side hooks<span><a class="mark" href="#all_client_side_hooks" id="all_client_side_hooks">#</a></span></h1>
<p>Most of these hooks are called during or in order to set up the formatting process.

</p>
<h2>documentReady<span><a class="mark" href="#all_documentready" id="all_documentready">#</a></span></h2>
<p>Called from: src/templates/pad.html

</p>
<p>Things in context:

</p>
<p>nothing

</p>
<p>This hook proxies the functionality of jQuery&apos;s <code>$(document).ready</code> event.

</p>
<h2>aceDomLineProcessLineAttributes<span><a class="mark" href="#all_acedomlineprocesslineattributes" id="all_acedomlineprocesslineattributes">#</a></span></h2>
<p>Called from: src/static/js/domline.js

</p>
<p>Things in context:

</p>
<ol>
<li>domline - The current DOM line being processed</li>
<li>cls - The class of the current block element (useful for styling)</li>
</ol>
<p>This hook is called for elements in the DOM that have the &quot;lineMarkerAttribute&quot; set. You can add elements into this category with the aceRegisterBlockElements hook above.

</p>
<p>The return value of this hook should have the following structure:

</p>
<p><code>{ preHtml: String, postHtml: String, processedMarker: Boolean }</code>

</p>
<p>The preHtml and postHtml values will be added to the HTML display of the element, and if processedMarker is true, the engine won&apos;t try to process it any more.

</p>
<h2>aceCreateDomLine<span><a class="mark" href="#all_acecreatedomline" id="all_acecreatedomline">#</a></span></h2>
<p>Called from: src/static/js/domline.js

</p>
<p>Things in context:

</p>
<ol>
<li>domline - the current DOM line being processed</li>
<li>cls - The class of the current element (useful for styling)</li>
</ol>
<p>This hook is called for any line being processed by the formatting engine, unless the aceDomLineProcessLineAttributes hook from above returned true, in which case this hook is skipped.

</p>
<p>The return value of this hook should have the following structure:

</p>
<p><code>{ extraOpenTags: String, extraCloseTags: String, cls: String }</code>

</p>
<p>extraOpenTags and extraCloseTags will be added before and after the element in question, and cls will be the new class of the element going forward.

</p>
<h2>acePostWriteDomLineHTML<span><a class="mark" href="#all_acepostwritedomlinehtml" id="all_acepostwritedomlinehtml">#</a></span></h2>
<p>Called from: src/static/js/domline.js

</p>
<p>Things in context:

</p>
<ol>
<li>node - the DOM node that just got written to the page</li>
</ol>
<p>This hook is for right after a node has been fully formatted and written to the page.

</p>
<h2>aceAttribsToClasses<span><a class="mark" href="#all_aceattribstoclasses" id="all_aceattribstoclasses">#</a></span></h2>
<p>Called from: src/static/js/linestylefilter.js

</p>
<p>Things in context:

</p>
<ol>
<li>linestylefilter - the JavaScript object that&apos;s currently processing the ace attributes</li>
<li>key - the current attribute being processed</li>
<li>value - the value of the attribute being processed</li>
</ol>
<p>This hook is called during the attribute processing procedure, and should be used to translate key, value pairs into valid HTML classes that can be inserted into the DOM.

</p>
<p>The return value for this function should be a list of classes, which will then be parsed into a valid class string.

</p>
<h2>aceGetFilterStack<span><a class="mark" href="#all_acegetfilterstack" id="all_acegetfilterstack">#</a></span></h2>
<p>Called from: src/static/js/linestylefilter.js

</p>
<p>Things in context:

</p>
<ol>
<li>linestylefilter - the JavaScript object that&apos;s currently processing the ace attributes</li>
<li>browser - an object indicating which browser is accessing the page</li>
</ol>
<p>This hook is called to apply custom regular expression filters to a set of styles. The one example available is the ep_linkify plugin, which adds internal links. They use it to find the telltale <code>[[ ]]</code> syntax that signifies internal links, and finding that syntax, they add in the internalHref attribute to be later used by the aceCreateDomLine hook (documented above).

</p>
<h2>aceEditorCSS<span><a class="mark" href="#all_aceeditorcss" id="all_aceeditorcss">#</a></span></h2>
<p>Called from: src/static/js/ace.js

</p>
<p>Things in context: None

</p>
<p>This hook is provided to allow custom CSS files to be loaded. The return value should be an array of paths relative to the plugins directory.

</p>
<h2>aceInitInnerdocbodyHead<span><a class="mark" href="#all_aceinitinnerdocbodyhead" id="all_aceinitinnerdocbodyhead">#</a></span></h2>
<p>Called from: src/static/js/ace.js

</p>
<p>Things in context:

</p>
<ol>
<li>iframeHTML - the HTML of the editor iframe up to this point, in array format</li>
</ol>
<p>This hook is called during the creation of the editor HTML. The array should have lines of HTML added to it, giving the plugin author a chance to add in meta, script, link, and other tags that go into the <code>&lt;head&gt;</code> element of the editor HTML document.

</p>
<h2>aceEditEvent<span><a class="mark" href="#all_aceeditevent" id="all_aceeditevent">#</a></span></h2>
<p>Called from: src/static/js/ace2_inner.js

</p>
<p>Things in context:

</p>
<ol>
<li>callstack - a bunch of information about the current action</li>
<li>editorInfo - information about the user who is making the change</li>
<li>rep - information about where the change is being made</li>
<li>documentAttributeManager - information about attributes in the document (this is a mystery to me)</li>
</ol>
<p>This hook is made available to edit the edit events that might occur when changes are made. Currently you can change the editor information, some of the meanings of the edit, and so on. You can also make internal changes (internal to your plugin) that use the information provided by the edit event.

</p>
<h2>aceRegisterBlockElements<span><a class="mark" href="#all_aceregisterblockelements" id="all_aceregisterblockelements">#</a></span></h2>
<p>Called from: src/static/js/ace2_inner.js

</p>
<p>Things in context: None

</p>
<p>The return value of this hook will add elements into the &quot;lineMarkerAttribute&quot; category, making the aceDomLineProcessLineAttributes hook (documented below) call for those elements.

</p>
<h2>aceInitialized<span><a class="mark" href="#all_aceinitialized" id="all_aceinitialized">#</a></span></h2>
<p>Called from: src/static/js/ace2_inner.js

</p>
<p>Things in context:

</p>
<ol>
<li>editorInfo - information about the user who will be making changes through the interface, and a way to insert functions into the main ace object (see ep_headings)</li>
<li>rep - information about where the user&apos;s cursor is</li>
<li>documentAttributeManager - some kind of magic</li>
</ol>
<p>This hook is for inserting further information into the ace engine, for later use in formatting hooks.

</p>
<h2>postAceInit<span><a class="mark" href="#all_postaceinit" id="all_postaceinit">#</a></span></h2>
<p>Called from: src/static/js/pad.js

</p>
<p>Things in context:

</p>
<ol>
<li>ace - the ace object that is applied to this editor.</li>
</ol>
<p>There doesn&apos;t appear to be any example available of this particular hook being used, but it gets fired after the editor is all set up.

</p>
<h2>userJoinOrUpdate<span><a class="mark" href="#all_userjoinorupdate" id="all_userjoinorupdate">#</a></span></h2>
<p>Called from: src/static/js/pad_userlist.js

</p>
<p>Things in context:

</p>
<ol>
<li>info - the user information</li>
</ol>
<p>This hook is called on the client side whenever a user joins or changes. This can be used to create notifications or an alternate user list.

</p>
<h2>collectContentPre<span><a class="mark" href="#all_collectcontentpre" id="all_collectcontentpre">#</a></span></h2>
<p>Called from: src/static/js/contentcollector.js

</p>
<p>Things in context:

</p>
<ol>
<li>cc - the contentcollector object</li>
<li>state - the current state of the change being made</li>
<li>tname - the tag name of this node currently being processed</li>
<li>style - the style applied to the node (probably CSS)</li>
<li>cls - the HTML class string of the node</li>
</ol>
<p>This hook is called before the content of a node is collected by the usual methods. The cc object can be used to do a bunch of things that modify the content of the pad. See, for example, the heading1 plugin for etherpad original.

</p>
<h2>collectContentPost<span><a class="mark" href="#all_collectcontentpost" id="all_collectcontentpost">#</a></span></h2>
<p>Called from: src/static/js/contentcollector.js

</p>
<p>Things in context:

</p>
<ol>
<li>cc - the contentcollector object</li>
<li>state - the current state of the change being made</li>
<li>tname - the tag name of this node currently being processed</li>
<li>style - the style applied to the node (probably CSS)</li>
<li>cls - the HTML class string of the node</li>
</ol>
<p>This hook is called after the content of a node is collected by the usual methods. The cc object can be used to do a bunch of things that modify the content of the pad. See, for example, the heading1 plugin for etherpad original.

</p>
<h2>handleClientMessage_<code>name</code><span><a class="mark" href="#all_handleclientmessage_name" id="all_handleclientmessage_name">#</a></span></h2>
<p>Called from: <code>src/static/js/collab_client.js</code>

</p>
<p>Things in context:

</p>
<ol>
<li>payload - the data that got sent with the message (use it for custom message content)</li>
</ol>
<p>This hook gets called every time the client receives a message of type <code>name</code>. This can most notably be used with the new HTTP API call, &quot;sendClientsMessage&quot;, which sends a custom message type to all clients connected to a pad. You can also use this to handle existing types.

</p>
<p><code>collab_client.js</code> has a pretty extensive list of message types, if you want to take a look.

</p>
<h2>aceStartLineAndCharForPoint-aceEndLineAndCharForPoint<span><a class="mark" href="#all_acestartlineandcharforpoint_aceendlineandcharforpoint" id="all_acestartlineandcharforpoint_aceendlineandcharforpoint">#</a></span></h2>
<p>Called from: src/static/js/ace2_inner.js

</p>
<p>Things in context:

</p>
<ol>
<li>callstack - a bunch of information about the current action</li>
<li>editorInfo - information about the user who is making the change</li>
<li>rep - information about where the change is being made</li>
<li>root - the span element of the current line</li>
<li>point - the starting/ending element where the cursor highlights</li>
<li>documentAttributeManager - information about attributes in the document</li>
</ol>
<p>This hook is provided to allow a plugin to turn DOM node selection into [line,char] selection.
The return value should be an array of [line,char]

</p>
<h2>aceKeyEvent<span><a class="mark" href="#all_acekeyevent" id="all_acekeyevent">#</a></span></h2>
<p>Called from: src/static/js/ace2_inner.js

</p>
<p>Things in context:

</p>
<ol>
<li>callstack - a bunch of information about the current action</li>
<li>editorInfo - information about the user who is making the change</li>
<li>rep - information about where the change is being made</li>
<li>documentAttributeManager - information about attributes in the document</li>
<li>evt - the fired event</li>
</ol>
<p>This hook is provided to allow a plugin to handle key events.
The return value should be true if you have handled the event.

</p>
<h2>collectContentLineText<span><a class="mark" href="#all_collectcontentlinetext" id="all_collectcontentlinetext">#</a></span></h2>
<p>Called from: src/static/js/contentcollector.js

</p>
<p>Things in context:

</p>
<ol>
<li>cc - the contentcollector object</li>
<li>state - the current state of the change being made</li>
<li>tname - the tag name of this node currently being processed</li>
<li>text - the text for that line</li>
</ol>
<p>This hook allows you to validate/manipulate the text before it&apos;s sent to the server side.
The return value should be the validated/manipulated text.

</p>
<h2>collectContentLineBreak<span><a class="mark" href="#all_collectcontentlinebreak" id="all_collectcontentlinebreak">#</a></span></h2>
<p>Called from: src/static/js/contentcollector.js

</p>
<p>Things in context:

</p>
<ol>
<li>cc - the contentcollector object</li>
<li>state - the current state of the change being made</li>
<li>tname - the tag name of this node currently being processed</li>
</ol>
<p>This hook is provided to allow whether the br tag should induce a new magic domline or not.
The return value should be either true(break the line) or false.

</p>
<h2>disableAuthorColorsForThisLine<span><a class="mark" href="#all_disableauthorcolorsforthisline" id="all_disableauthorcolorsforthisline">#</a></span></h2>
<p>Called from: src/static/js/linestylefilter.js

</p>
<p>Things in context:

</p>
<ol>
<li>linestylefilter - the JavaScript object that&apos;s currently processing the ace attributes</li>
<li>text - the line text</li>
<li>class - line class</li>
</ol>
<p>This hook is provided to allow whether a given line should be deliniated with multiple authors.
Multiple authors in one line cause the creation of magic span lines. This might not suit you and
now you can disable it and handle your own deliniation.
The return value should be either true(disable) or false.

</p>
<h1>Server-side hooks<span><a class="mark" href="#all_server_side_hooks" id="all_server_side_hooks">#</a></span></h1>
<p>These hooks are called on server-side.

</p>
<h2>loadSettings<span><a class="mark" href="#all_loadsettings" id="all_loadsettings">#</a></span></h2>
<p>Called from: src/node/server.js

</p>
<p>Things in context:

</p>
<ol>
<li>settings - the settings object</li>
</ol>
<p>Use this hook to receive the global settings in your plugin.

</p>
<h2>pluginUninstall<span><a class="mark" href="#all_pluginuninstall" id="all_pluginuninstall">#</a></span></h2>
<p>Called from: src/static/js/pluginfw/installer.js

</p>
<p>Things in context:

</p>
<ol>
<li>plugin_name - self-explanatory</li>
</ol>
<p>If this hook returns an error, the callback to the uninstall function gets an error as well. This mostly seems useful for handling additional features added in based on the installation of other plugins, which is pretty cool!

</p>
<h2>pluginInstall<span><a class="mark" href="#all_plugininstall" id="all_plugininstall">#</a></span></h2>
<p>Called from: src/static/js/pluginfw/installer.js

</p>
<p>Things in context:

</p>
<ol>
<li>plugin_name - self-explanatory</li>
</ol>
<p>If this hook returns an error, the callback to the install function gets an error, too. This seems useful for adding in features when a particular plugin is installed.

</p>
<h2>init_<code>&lt;plugin name&gt;</code><span><a class="mark" href="#all_init_plugin_name" id="all_init_plugin_name">#</a></span></h2>
<p>Called from: src/static/js/pluginfw/plugins.js

</p>
<p>Things in context: None

</p>
<p>This function is called after a specific plugin is initialized. This would probably be more useful than the previous two functions if you only wanted to add in features to one specific plugin.

</p>
<h2>expressConfigure<span><a class="mark" href="#all_expressconfigure" id="all_expressconfigure">#</a></span></h2>
<p>Called from: src/node/server.js

</p>
<p>Things in context:

</p>
<ol>
<li>app - the main application object</li>
</ol>
<p>This is a helpful hook for changing the behavior and configuration of the application. It&apos;s called right after the application gets configured.

</p>
<h2>expressCreateServer<span><a class="mark" href="#all_expresscreateserver" id="all_expresscreateserver">#</a></span></h2>
<p>Called from: src/node/server.js

</p>
<p>Things in context:

</p>
<ol>
<li>app - the main application object (helpful for adding new paths and such)</li>
</ol>
<p>This hook gets called after the application object has been created, but before it starts listening. This is similar to the expressConfigure hook, but it&apos;s not guaranteed that the application object will have all relevant configuration variables.

</p>
<h2>eejsBlock_<code>&lt;name&gt;</code><span><a class="mark" href="#all_eejsblock_name" id="all_eejsblock_name">#</a></span></h2>
<p>Called from: src/node/eejs/index.js

</p>
<p>Things in context:

</p>
<ol>
<li>content - the content of the block</li>
</ol>
<p>This hook gets called upon the rendering of an ejs template block. For any specific kind of block, you can change how that block gets rendered by modifying the content object passed in.

</p>
<p>Have a look at <code>src/templates/pad.html</code> and <code>src/templates/timeslider.html</code> to see which blocks are available.

</p>
<h2>socketio<span><a class="mark" href="#all_socketio" id="all_socketio">#</a></span></h2>
<p>Called from: src/node/hooks/express/socketio.js

</p>
<p>Things in context:

</p>
<ol>
<li>app - the application object</li>
<li>io - the socketio object</li>
</ol>
<p>I have no idea what this is useful for, someone else will have to add this description.

</p>
<h2>authorize<span><a class="mark" href="#all_authorize" id="all_authorize">#</a></span></h2>
<p>Called from: src/node/hooks/express/webaccess.js

</p>
<p>Things in context:

</p>
<ol>
<li>req - the request object</li>
<li>res - the response object</li>
<li>next - ?</li>
<li>resource - the path being accessed</li>
</ol>
<p>This is useful for modifying the way authentication is done, especially for specific paths.

</p>
<h2>authenticate<span><a class="mark" href="#all_authenticate" id="all_authenticate">#</a></span></h2>
<p>Called from: src/node/hooks/express/webaccess.js

</p>
<p>Things in context:

</p>
<ol>
<li>req - the request object</li>
<li>res - the response object</li>
<li>next - ?</li>
<li>username - the username used (optional)</li>
<li>password - the password used (optional)</li>
</ol>
<p>This is useful for modifying the way authentication is done.

</p>
<h2>authFailure<span><a class="mark" href="#all_authfailure" id="all_authfailure">#</a></span></h2>
<p>Called from: src/node/hooks/express/webaccess.js

</p>
<p>Things in context:

</p>
<ol>
<li>req - the request object</li>
<li>res - the response object</li>
<li>next - ?</li>
</ol>
<p>This is useful for modifying the way authentication is done.

</p>
<h2>handleMessage<span><a class="mark" href="#all_handlemessage" id="all_handlemessage">#</a></span></h2>
<p>Called from: src/node/handler/PadMessageHandler.js

</p>
<p>Things in context:

</p>
<ol>
<li>message - the message being handled</li>
<li>client - the client object from socket.io</li>
</ol>
<p>This hook will be called once a message arrive. If a plugin calls <code>callback(null)</code> the message will be dropped. However it is not possible to modify the message.

</p>
<p>Plugins may also decide to implement custom behavior once a message arrives.

</p>
<p><strong>WARNING</strong>: handleMessage will be called, even if the client is not authorized to send this message. It&apos;s up to the plugin to check permissions.

</p>
<p>Example:

</p>
<pre><code>function handleMessage ( hook, context, callback ) {
  if ( context.message.type == &apos;USERINFO_UPDATE&apos; ) {
    // If the message type is USERINFO_UPDATE, drop the message
    callback(null);
  }else{
    callback();
  }
};</code></pre>
<h2>getLineHTMLForExport<span><a class="mark" href="#all_getlinehtmlforexport" id="all_getlinehtmlforexport">#</a></span></h2>
<p>Called from: src/node/utils/ExportHtml.js

</p>
<p>Things in context:

</p>
<ol>
<li>apool - pool object</li>
<li>attribLine - line attributes</li>
<li>text - line text</li>
</ol>
<p>This hook will allow a plug-in developer to re-write each line when exporting to HTML.


</p>
<h1>editorInfo<span><a class="mark" href="#all_editorinfo" id="all_editorinfo">#</a></span></h1>
<h2>editorInfo.ace_replaceRange(start, end, text)<span><a class="mark" href="#all_editorinfo_ace_replacerange_start_end_text" id="all_editorinfo_ace_replacerange_start_end_text">#</a></span></h2>
<p>This function replaces a range (from <code>start</code> to <code>end</code>) with <code>text</code>.

</p>
<h2>editorInfo.ace_getRep()<span><a class="mark" href="#all_editorinfo_ace_getrep" id="all_editorinfo_ace_getrep">#</a></span></h2>
<p>Returns the <code>rep</code> object.

</p>
<h2>editorInfo.ace_getAuthor()<span><a class="mark" href="#all_editorinfo_ace_getauthor" id="all_editorinfo_ace_getauthor">#</a></span></h2>
<h2>editorInfo.ace_inCallStack()<span><a class="mark" href="#all_editorinfo_ace_incallstack" id="all_editorinfo_ace_incallstack">#</a></span></h2>
<h2>editorInfo.ace_inCallStackIfNecessary(?)<span><a class="mark" href="#all_editorinfo_ace_incallstackifnecessary" id="all_editorinfo_ace_incallstackifnecessary">#</a></span></h2>
<h2>editorInfo.ace_focus(?)<span><a class="mark" href="#all_editorinfo_ace_focus" id="all_editorinfo_ace_focus">#</a></span></h2>
<h2>editorInfo.ace_importText(?)<span><a class="mark" href="#all_editorinfo_ace_importtext" id="all_editorinfo_ace_importtext">#</a></span></h2>
<h2>editorInfo.ace_importAText(?)<span><a class="mark" href="#all_editorinfo_ace_importatext" id="all_editorinfo_ace_importatext">#</a></span></h2>
<h2>editorInfo.ace_exportText(?)<span><a class="mark" href="#all_editorinfo_ace_exporttext" id="all_editorinfo_ace_exporttext">#</a></span></h2>
<h2>editorInfo.ace_editorChangedSize(?)<span><a class="mark" href="#all_editorinfo_ace_editorchangedsize" id="all_editorinfo_ace_editorchangedsize">#</a></span></h2>
<h2>editorInfo.ace_setOnKeyPress(?)<span><a class="mark" href="#all_editorinfo_ace_setonkeypress" id="all_editorinfo_ace_setonkeypress">#</a></span></h2>
<h2>editorInfo.ace_setOnKeyDown(?)<span><a class="mark" href="#all_editorinfo_ace_setonkeydown" id="all_editorinfo_ace_setonkeydown">#</a></span></h2>
<h2>editorInfo.ace_setNotifyDirty(?)<span><a class="mark" href="#all_editorinfo_ace_setnotifydirty" id="all_editorinfo_ace_setnotifydirty">#</a></span></h2>
<h2>editorInfo.ace_dispose(?)<span><a class="mark" href="#all_editorinfo_ace_dispose" id="all_editorinfo_ace_dispose">#</a></span></h2>
<h2>editorInfo.ace_getFormattedCode(?)<span><a class="mark" href="#all_editorinfo_ace_getformattedcode" id="all_editorinfo_ace_getformattedcode">#</a></span></h2>
<h2>editorInfo.ace_setEditable(bool)<span><a class="mark" href="#all_editorinfo_ace_seteditable_bool" id="all_editorinfo_ace_seteditable_bool">#</a></span></h2>
<h2>editorInfo.ace_execCommand(?)<span><a class="mark" href="#all_editorinfo_ace_execcommand" id="all_editorinfo_ace_execcommand">#</a></span></h2>
<h2>editorInfo.ace_callWithAce(fn, callStack, normalize)<span><a class="mark" href="#all_editorinfo_ace_callwithace_fn_callstack_normalize" id="all_editorinfo_ace_callwithace_fn_callstack_normalize">#</a></span></h2>
<h2>editorInfo.ace_setProperty(key, value)<span><a class="mark" href="#all_editorinfo_ace_setproperty_key_value" id="all_editorinfo_ace_setproperty_key_value">#</a></span></h2>
<h2>editorInfo.ace_setBaseText(txt)<span><a class="mark" href="#all_editorinfo_ace_setbasetext_txt" id="all_editorinfo_ace_setbasetext_txt">#</a></span></h2>
<h2>editorInfo.ace_setBaseAttributedText(atxt, apoolJsonObj)<span><a class="mark" href="#all_editorinfo_ace_setbaseattributedtext_atxt_apooljsonobj" id="all_editorinfo_ace_setbaseattributedtext_atxt_apooljsonobj">#</a></span></h2>
<h2>editorInfo.ace_applyChangesToBase(c, optAuthor, apoolJsonObj)<span><a class="mark" href="#all_editorinfo_ace_applychangestobase_c_optauthor_apooljsonobj" id="all_editorinfo_ace_applychangestobase_c_optauthor_apooljsonobj">#</a></span></h2>
<h2>editorInfo.ace_prepareUserChangeset()<span><a class="mark" href="#all_editorinfo_ace_prepareuserchangeset" id="all_editorinfo_ace_prepareuserchangeset">#</a></span></h2>
<h2>editorInfo.ace_applyPreparedChangesetToBase()<span><a class="mark" href="#all_editorinfo_ace_applypreparedchangesettobase" id="all_editorinfo_ace_applypreparedchangesettobase">#</a></span></h2>
<h2>editorInfo.ace_setUserChangeNotificationCallback(f)<span><a class="mark" href="#all_editorinfo_ace_setuserchangenotificationcallback_f" id="all_editorinfo_ace_setuserchangenotificationcallback_f">#</a></span></h2>
<h2>editorInfo.ace_setAuthorInfo(author, info)<span><a class="mark" href="#all_editorinfo_ace_setauthorinfo_author_info" id="all_editorinfo_ace_setauthorinfo_author_info">#</a></span></h2>
<h2>editorInfo.ace_setAuthorSelectionRange(author, start, end)<span><a class="mark" href="#all_editorinfo_ace_setauthorselectionrange_author_start_end" id="all_editorinfo_ace_setauthorselectionrange_author_start_end">#</a></span></h2>
<h2>editorInfo.ace_getUnhandledErrors()<span><a class="mark" href="#all_editorinfo_ace_getunhandlederrors" id="all_editorinfo_ace_getunhandlederrors">#</a></span></h2>
<h2>editorInfo.ace_getDebugProperty(prop)<span><a class="mark" href="#all_editorinfo_ace_getdebugproperty_prop" id="all_editorinfo_ace_getdebugproperty_prop">#</a></span></h2>
<h2>editorInfo.ace_fastIncorp(?)<span><a class="mark" href="#all_editorinfo_ace_fastincorp" id="all_editorinfo_ace_fastincorp">#</a></span></h2>
<h2>editorInfo.ace_isCaret(?)<span><a class="mark" href="#all_editorinfo_ace_iscaret" id="all_editorinfo_ace_iscaret">#</a></span></h2>
<h2>editorInfo.ace_getLineAndCharForPoint(?)<span><a class="mark" href="#all_editorinfo_ace_getlineandcharforpoint" id="all_editorinfo_ace_getlineandcharforpoint">#</a></span></h2>
<h2>editorInfo.ace_performDocumentApplyAttributesToCharRange(?)<span><a class="mark" href="#all_editorinfo_ace_performdocumentapplyattributestocharrange" id="all_editorinfo_ace_performdocumentapplyattributestocharrange">#</a></span></h2>
<h2>editorInfo.ace_setAttributeOnSelection(?)<span><a class="mark" href="#all_editorinfo_ace_setattributeonselection" id="all_editorinfo_ace_setattributeonselection">#</a></span></h2>
<h2>editorInfo.ace_toggleAttributeOnSelection(?)<span><a class="mark" href="#all_editorinfo_ace_toggleattributeonselection" id="all_editorinfo_ace_toggleattributeonselection">#</a></span></h2>
<h2>editorInfo.ace_performSelectionChange(?)<span><a class="mark" href="#all_editorinfo_ace_performselectionchange" id="all_editorinfo_ace_performselectionchange">#</a></span></h2>
<h2>editorInfo.ace_doIndentOutdent(?)<span><a class="mark" href="#all_editorinfo_ace_doindentoutdent" id="all_editorinfo_ace_doindentoutdent">#</a></span></h2>
<h2>editorInfo.ace_doUndoRedo(?)<span><a class="mark" href="#all_editorinfo_ace_doundoredo" id="all_editorinfo_ace_doundoredo">#</a></span></h2>
<h2>editorInfo.ace_doInsertUnorderedList(?)<span><a class="mark" href="#all_editorinfo_ace_doinsertunorderedlist" id="all_editorinfo_ace_doinsertunorderedlist">#</a></span></h2>
<h2>editorInfo.ace_doInsertOrderedList(?)<span><a class="mark" href="#all_editorinfo_ace_doinsertorderedlist" id="all_editorinfo_ace_doinsertorderedlist">#</a></span></h2>
<h2>editorInfo.ace_performDocumentApplyAttributesToRange()<span><a class="mark" href="#all_editorinfo_ace_performdocumentapplyattributestorange" id="all_editorinfo_ace_performdocumentapplyattributestorange">#</a></span></h2>
<h2>editorInfo.ace_getAuthorInfos()<span><a class="mark" href="#all_editorinfo_ace_getauthorinfos" id="all_editorinfo_ace_getauthorinfos">#</a></span></h2>
<p>Returns an info object about the author. Object key = author_id and info includes author&apos;s bg color value.
Use to define your own authorship.
</p>
<h2>editorInfo.ace_performDocumentReplaceRange(start, end, newText)<span><a class="mark" href="#all_editorinfo_ace_performdocumentreplacerange_start_end_newtext" id="all_editorinfo_ace_performdocumentreplacerange_start_end_newtext">#</a></span></h2>
<p>This function replaces a range (from [x1,y1] to [x2,y2]) with <code>newText</code>.
</p>
<h2>editorInfo.ace_performDocumentReplaceCharRange(startChar, endChar, newText)<span><a class="mark" href="#all_editorinfo_ace_performdocumentreplacecharrange_startchar_endchar_newtext" id="all_editorinfo_ace_performdocumentreplacecharrange_startchar_endchar_newtext">#</a></span></h2>
<p>This function replaces a range (from y1 to y2) with <code>newText</code>.
</p>
<h2>editorInfo.ace_renumberList(lineNum)<span><a class="mark" href="#all_editorinfo_ace_renumberlist_linenum" id="all_editorinfo_ace_renumberlist_linenum">#</a></span></h2>
<p>If you delete a line, calling this method will fix the line numbering.
</p>
<h2>editorInfo.ace_doReturnKey()<span><a class="mark" href="#all_editorinfo_ace_doreturnkey" id="all_editorinfo_ace_doreturnkey">#</a></span></h2>
<p>Forces a return key at the current carret position.
</p>
<h2>editorInfo.ace_isBlockElement(element)<span><a class="mark" href="#all_editorinfo_ace_isblockelement_element" id="all_editorinfo_ace_isblockelement_element">#</a></span></h2>
<p>Returns true if your passed elment is registered as a block element
</p>
<h2>editorInfo.ace_getLineListType(lineNum)<span><a class="mark" href="#all_editorinfo_ace_getlinelisttype_linenum" id="all_editorinfo_ace_getlinelisttype_linenum">#</a></span></h2>
<p>Returns the line&apos;s html list type.
</p>
<h2>editorInfo.ace_caretLine()<span><a class="mark" href="#all_editorinfo_ace_caretline" id="all_editorinfo_ace_caretline">#</a></span></h2>
<p>Returns X position of the caret.
</p>
<h2>editorInfo.ace_caretColumn()<span><a class="mark" href="#all_editorinfo_ace_caretcolumn" id="all_editorinfo_ace_caretcolumn">#</a></span></h2>
<p>Returns Y position of the caret.
</p>
<h2>editorInfo.ace_caretDocChar()<span><a class="mark" href="#all_editorinfo_ace_caretdocchar" id="all_editorinfo_ace_caretdocchar">#</a></span></h2>
<p>Returns the Y offset starting from [x=0,y=0]
</p>
<h2>editorInfo.ace_isWordChar(?)<span><a class="mark" href="#all_editorinfo_ace_iswordchar" id="all_editorinfo_ace_iswordchar">#</a></span></h2>
<h1>Changeset Library<span><a class="mark" href="#all_changeset_library" id="all_changeset_library">#</a></span></h1>
<pre><code>&quot;Z:z&gt;1|2=m=b*0|1+1$\n&quot;</code></pre>
<p>This is a Changeset. Its just a string and its very difficult to read in this form. But the Changeset Library gives us some tools to read it.

</p>
<p>A changeset describes the diff between two revisions of the document. The Browser sends changesets to the server and the server sends them to the clients to update them. This Changesets gets also saved into the history of a pad. Which allows us to go back to every revision from the past.

</p>
<h2>Changeset.unpack(changeset)<span><a class="mark" href="#all_changeset_unpack_changeset" id="all_changeset_unpack_changeset">#</a></span></h2>
<div class="signature"><ul>
<li><code>changeset</code> <span class="type">String</span></li>
</div></ul>
<p>This functions returns an object representaion of the changeset, similar to this:

</p>
<pre><code>{ oldLen: 35, newLen: 36, ops: &apos;|2=m=b*0|1+1&apos;, charBank: &apos;\n&apos; }</code></pre>
<ul>
<li><code>oldLen</code> {Number} the original length of the document.</li>
<li><code>newLen</code> {Number} the length of the document after the changeset is applied.</li>
<li><code>ops</code> {String} the actual changes, introduced by this changeset.</li>
<li><code>charBank</code> {String} All characters that are added by this changeset.</li>
</ul>
<h2>Changeset.opIterator(ops)<span><a class="mark" href="#all_changeset_opiterator_ops" id="all_changeset_opiterator_ops">#</a></span></h2>
<div class="signature"><ul>
<li><code>ops</code> <span class="type">String</span> The operators, returned by <code>Changeset.unpack()</code></li>
</div></ul>
<p>Returns an operator iterator. This iterator allows us to iterate over all operators that are in the changeset.

</p>
<p>You can iterate with an opIterator using its <code>next()</code> and <code>hasNext()</code> methods. Next returns the <code>next()</code> operator object and <code>hasNext()</code> indicates, whether there are any operators left.

</p>
<h2>The Operator object<span><a class="mark" href="#all_the_operator_object" id="all_the_operator_object">#</a></span></h2>
<p>There are 3 types of operators: <code>+</code>,<code>-</code> and <code>=</code>. These operators describe different changes to the document, beginning with the first character of the document. A <code>=</code> operator doesn&apos;t change the text, but it may add or remove text attributes. A <code>-</code> operator removes text. And a <code>+</code> Operator adds text and optionally adds some attributes to it.

</p>
<ul>
<li><code>opcode</code> {String} the operator type</li>
<li><code>chars</code> {Number} the length of the text changed by this operator.</li>
<li><code>lines</code> {Number} the number of lines changed by this operator.</li>
<li><code>attribs</code> {attribs} attributes set on this text.</li>
</ul>
<h3>Example<span><a class="mark" href="#all_example" id="all_example">#</a></span></h3>
<pre><code>{ opcode: &apos;+&apos;,
  chars: 1,
  lines: 1,
  attribs: &apos;*0&apos; }</code></pre>
<h2>APool<span><a class="mark" href="#all_apool" id="all_apool">#</a></span></h2>
<pre><code>&gt; var AttributePoolFactory = require(&quot;./utils/AttributePoolFactory&quot;);
&gt; var apool = AttributePoolFactory.createAttributePool();
&gt; console.log(apool)
{ numToAttrib: {},
  attribToNum: {},
  nextNum: 0,
  putAttrib: [Function],
  getAttrib: [Function],
  getAttribKey: [Function],
  getAttribValue: [Function],
  eachAttrib: [Function],
  toJsonable: [Function],
  fromJsonable: [Function] }</code></pre>
<p>This creates an empty apool. A apool saves which attributes were used during the history of a pad. There is one apool for each pad. It only saves the attributes that were really used, it doesn&apos;t save unused attributes. Lets fill this apool with some values

</p>
<pre><code>&gt; apool.fromJsonable({&quot;numToAttrib&quot;:{&quot;0&quot;:[&quot;author&quot;,&quot;a.kVnWeomPADAT2pn9&quot;],&quot;1&quot;:[&quot;bold&quot;,&quot;true&quot;],&quot;2&quot;:[&quot;italic&quot;,&quot;true&quot;]},&quot;nextNum&quot;:3});
&gt; console.log(apool)
{ numToAttrib: 
   { &apos;0&apos;: [ &apos;author&apos;, &apos;a.kVnWeomPADAT2pn9&apos; ],
     &apos;1&apos;: [ &apos;bold&apos;, &apos;true&apos; ],
     &apos;2&apos;: [ &apos;italic&apos;, &apos;true&apos; ] },
  attribToNum: 
   { &apos;author,a.kVnWeomPADAT2pn9&apos;: 0,
     &apos;bold,true&apos;: 1,
     &apos;italic,true&apos;: 2 },
  nextNum: 3,
  putAttrib: [Function],
  getAttrib: [Function],
  getAttribKey: [Function],
  getAttribValue: [Function],
  eachAttrib: [Function],
  toJsonable: [Function],
  fromJsonable: [Function] }</code></pre>
<p>We used the fromJsonable function to fill the empty apool with values. the fromJsonable and toJsonable functions are used to serialize and deserialize an apool. You can see that it stores the relation between numbers and attributes. So for example the attribute 1 is the attribute bold and vise versa. A attribute is always a key value pair. For stuff like bold and italic its just  &apos;italic&apos;:&apos;true&apos;. For authors its author:$AUTHORID. So a character can be bold and italic. But it can&apos;t belong to multiple authors

</p>
<pre><code>&gt; apool.getAttrib(1)
[ &apos;bold&apos;, &apos;true&apos; ]</code></pre>
<p>Simple example of how to get the key value pair for the attribute 1

</p>
<h2>AText<span><a class="mark" href="#all_atext" id="all_atext">#</a></span></h2>
<pre><code>&gt; var atext = {&quot;text&quot;:&quot;bold text\nitalic text\nnormal text\n\n&quot;,&quot;attribs&quot;:&quot;*0*1+9*0|1+1*0*1*2+b|1+1*0+b|2+2&quot;};
&gt; console.log(atext)
{ text: &apos;bold text\nitalic text\nnormal text\n\n&apos;,
  attribs: &apos;*0*1+9*0|1+1*0*1*2+b|1+1*0+b|2+2&apos; }</code></pre>
<p>This is an atext. An atext has two parts: text and attribs. The text is just the text of the pad as a string. We will look closer at the attribs at the next steps

</p>
<pre><code>&gt; var opiterator = Changeset.opIterator(atext.attribs)
&gt; console.log(opiterator)
{ next: [Function: next],
  hasNext: [Function: hasNext],
  lastIndex: [Function: lastIndex] }
&gt; opiterator.next()
{ opcode: &apos;+&apos;,
  chars: 9,
  lines: 0,
  attribs: &apos;*0*1&apos; }
&gt; opiterator.next()
{ opcode: &apos;+&apos;,
  chars: 1,
  lines: 1,
  attribs: &apos;*0&apos; }
&gt; opiterator.next()
{ opcode: &apos;+&apos;,
  chars: 11,
  lines: 0,
  attribs: &apos;*0*1*2&apos; }
&gt; opiterator.next()
{ opcode: &apos;+&apos;,
  chars: 1,
  lines: 1,
  attribs: &apos;&apos; }
&gt; opiterator.next()
{ opcode: &apos;+&apos;,
  chars: 11,
  lines: 0,
  attribs: &apos;*0&apos; }
&gt; opiterator.next()
{ opcode: &apos;+&apos;,
  chars: 2,
  lines: 2,
  attribs: &apos;&apos; }</code></pre>
<p>The attribs are again a bunch of operators like .ops in the changeset was. But these operators are only + operators. They describe which part of the text has which attributes

</p>
<p>For more information see /doc/easysync/easysync-notes.txt in the source.

</p>
<h1>Database structure<span><a class="mark" href="#all_database_structure" id="all_database_structure">#</a></span></h1>
<h2>Keys and their values<span><a class="mark" href="#all_keys_and_their_values" id="all_keys_and_their_values">#</a></span></h2>
<h3>groups<span><a class="mark" href="#all_groups_1" id="all_groups_1">#</a></span></h3>
<p>A list of all existing groups (a JSON object with groupIDs as keys and <code>1</code> as values).

</p>
<h3>pad:$PADID<span><a class="mark" href="#all_pad_padid" id="all_pad_padid">#</a></span></h3>
<p>Saves all informations about pads

</p>
<ul>
<li><strong>atext</strong> - the latest attributed text</li>
<li><strong>pool</strong> - the attribute pool</li>
<li><strong>head</strong> - the number of the latest revision</li>
<li><strong>chatHead</strong> - the number of the latest chat entry</li>
<li><strong>public</strong> - flag that disables security for this pad</li>
<li><strong>passwordHash</strong> - string that contains a bcrypt hashed password for this pad</li>
</ul>
<h3>pad:$PADID:revs:$REVNUM<span><a class="mark" href="#all_pad_padid_revs_revnum" id="all_pad_padid_revs_revnum">#</a></span></h3>
<p>Saves a revision $REVNUM of pad $PADID

</p>
<ul>
<li><strong>meta</strong><ul>
<li><strong>author</strong> - the autorID of this revision</li>
<li><strong>timestamp</strong> - the timestamp of when this revision was created</li>
</ul>
</li>
<li><strong>changeset</strong> - the changeset of this revision</li>
</ul>
<h3>pad:$PADID:chat:$CHATNUM<span><a class="mark" href="#all_pad_padid_chat_chatnum" id="all_pad_padid_chat_chatnum">#</a></span></h3>
<p>Saves a chatentry with num $CHATNUM of pad $PADID

</p>
<ul>
<li><strong>text</strong> - the text of this chat entry</li>
<li><strong>userId</strong> - the autorID of this chat entry</li>
<li><strong>time</strong> - the timestamp of this chat entry</li>
</ul>
<h3>pad2readonly:$PADID<span><a class="mark" href="#all_pad2readonly_padid" id="all_pad2readonly_padid">#</a></span></h3>
<p>Translates a padID to a readonlyID
</p>
<h3>readonly2pad:$READONLYID<span><a class="mark" href="#all_readonly2pad_readonlyid" id="all_readonly2pad_readonlyid">#</a></span></h3>
<p>Translates a readonlyID to a padID
</p>
<h3>token2author:$TOKENID<span><a class="mark" href="#all_token2author_tokenid" id="all_token2author_tokenid">#</a></span></h3>
<p>Translates a token to an authorID
</p>
<h3>globalAuthor:$AUTHORID<span><a class="mark" href="#all_globalauthor_authorid" id="all_globalauthor_authorid">#</a></span></h3>
<p>Information about an author

</p>
<ul>
<li><strong>name</strong> - the name of this author as shown in the pad</li>
<li><strong>colorID</strong> - the colorID of this author as shown in the pad</li>
</ul>
<h3>mapper2group:$MAPPER<span><a class="mark" href="#all_mapper2group_mapper" id="all_mapper2group_mapper">#</a></span></h3>
<p>Maps an external application identifier to an internal group 
</p>
<h3>mapper2author:$MAPPER<span><a class="mark" href="#all_mapper2author_mapper" id="all_mapper2author_mapper">#</a></span></h3>
<p>Maps an external application identifier to an internal author 
</p>
<h3>group:$GROUPID<span><a class="mark" href="#all_group_groupid" id="all_group_groupid">#</a></span></h3>
<p>a group of pads

</p>
<ul>
<li><strong>pads</strong> - object with pad names in it, values are 1<h3>session:$SESSIONID<span><a class="mark" href="#all_session_sessionid" id="all_session_sessionid">#</a></span></h3>
a session between an author and a group</li>
</ul>
<ul>
<li><strong>groupID</strong> - the groupID the session belongs too</li>
<li><strong>authorID</strong> - the authorID the session belongs too</li>
<li><strong>validUntil</strong> - the timestamp until this session is valid</li>
</ul>
<h3>author2sessions:$AUTHORID<span><a class="mark" href="#all_author2sessions_authorid" id="all_author2sessions_authorid">#</a></span></h3>
<p>saves the sessions of an author

</p>
<ul>
<li><strong>sessionsIDs</strong> - object with sessionIDs in it, values are 1</li>
</ul>
<h3>group2sessions:$GROUPID<span><a class="mark" href="#all_group2sessions_groupid" id="all_group2sessions_groupid">#</a></span></h3>
<div class="signature"><ul>
<li><strong>sessionsIDs</strong> - object with sessionIDs in it, values are 1</li>
</div></ul>

  </div>

</body>
</html>

